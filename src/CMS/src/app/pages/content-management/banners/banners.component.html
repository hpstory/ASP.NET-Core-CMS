<h3 [ngStyle]="{ margin: '16px 0' }">轮播图列表</h3>
<button nz-button (click)="addRow(banners.length)" nzType="primary">添加轮播图</button>
<nz-table #nzTable nzBordered [nzData]="banners" [nzLoading]="loading">
  <thead>
    <tr>
      <th nzWidth="30%">序号</th>
      <th>标题</th>
      <th>顺序</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of nzTable.data; let i = index">
      <td>{{ i + 1 }}</td>
      <td>{{ data.title }}</td>
      <td>{{ data.position }}</td>
      <td>
        <a (click)="showModal(data.id)"><span>编辑</span></a>
        <nz-divider nzType="vertical"></nz-divider>
        <a nz-popconfirm nzPopconfirmTitle="确认删除？" (nzOnConfirm)="deleteRow(data.id, banners.length)">删除</a>
      </td>
    </tr>
  </tbody>
</nz-table>
<nz-modal [(nzVisible)]="isVisible"
  nzTitle="轮播图管理" nzClosable="false" [nzFooter]="null">
  <form nz-form [formGroup]="newBannerForm">
    <nz-form-item>
      <nz-form-label [nzSpan]="5" nzRequired>封面</nz-form-label>
      <nz-form-control nzHasFeedback nzErrorTip="请选择封面！">
        <nz-upload
        nzAction={{uploadUrl}}
        nzName="formFile"
        nzListType="picture-card"
        [(nzFileList)]="fileList"
        [nzShowButton]="fileList.length < 1"
        [nzPreview]="handlePreview"
        [nzBeforeUpload]="beforeUpload"
        (nzChange)="getImageUrl($event)"
        class="cover-upload"
        >
          <div *ngIf="imageUrl == null">
            <i nz-icon nzType="plus"></i>
            <div class="ant-upload-text">上传封面</div>
          </div>
          <div *ngIf="imageUrl != null">
            <img [src]="imageUrl" [ngStyle]="{ width: '100%' }">
          </div>
        </nz-upload>
        <nz-modal class="preview"
        [nzVisible]="previewVisible"
        [nzContent]="modalContent"
        [nzFooter]="null"
        (nzOnCancel)="previewVisible = false"
        >
          <ng-template #modalContent>
            <img [src]="imageUrl" [ngStyle]="{ width: '100%' }" />
          </ng-template>
        </nz-modal>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="5" nzRequired>标题</nz-form-label>
      <nz-form-control nzHasFeedback [nzSpan]="12" nzErrorTip="请输入标题！">
        <input nz-input formControlName="title" required/>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="5">链接</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <input nz-input formControlName="link"/>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSpan]="5" nzRequired>顺序</nz-form-label>
      <nz-form-control nzHasFeedback [nzSpan]="12" nzErrorTip="请选择顺序！">
        <nz-input-number [nzMin]="1" [nzMax]="6" [nzStep]="1" formControlName="position" required></nz-input-number>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control >
        <div nz-row [nzGutter]="1">
          <button nz-col nzSpan="3" nzOffset="16" nz-button nzType="default" (click)="handleCancel()">取消</button>
          <button
          [nzLoading]="isOkLoading"
          nz-popconfirm nzPopconfirmTitle="确认提交？"
          (nzOnConfirm)="handleOk(newBannerForm.value, editId)"
          nz-col nzSpan="3" nzOffset="1" nz-button nzType="primary">提交</button>
        </div>
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-modal>

